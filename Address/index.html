<!DOCTYPE html>
<html>
<head>
	<title>Address Book</title>
	<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
	<h1>Address Book</h1>
	<span id="counter"></span>
	<div id="container">
		<form action="javascript:void(0);" method="POST" onsubmit="address.Add()"> 
		  <input type="text" id="addContactName" placeholder="Contact Name" required="required">
		  <input type="text" id="addContactNumber" placeholder="Contact Number" required="required">
		  <input type="submit" value="Add">
		</form>

		<div id="editForm" role="aria-hidden" style="display: none;">
		  <form action="javascript:void(0);" method="POST" id="saveEdit">
		    <input type="text" id="editContactName" required="required">
		    <input type="text" id="editContactNumber" required="required">
		    <input type="submit" value="Update" />
		  </form>
		</div>
		<br>
		<table>
		  <tr>
		  	<th>#</th>
		    <th>Name</th>
		    <th>Phone Number</th>
		    <th colspan=2>Action</th>
		  </tr>
		    <tbody id="contacts">
		    </tbody>
		</table>		
	</div>
	
	<script>
		var address = new function() {
	  		this.contactList = document.getElementById('contacts');
	  		this.contacts = [];

	  		this.Count = function(data) {
	    		var counter = document.getElementById('counter');
	    		var name = 'contact';
			    if (data) {
			      if (data > 1) {
			        name = 'contacts';
			      }
			      counter.innerHTML = data + ' ' + name ;
			    } else {
			      counter.innerHTML = 'No ' + name;
			    }
			};
	  
		  	this.FetchAll = function() {
		    	var data = '';
		    	if (this.contacts.length > 0) {
		      		for (i = 0; i < this.contacts.length; i++) {
		      			var details = this.contacts[i].split(" __");
		        		data += '<tr>';
				        data += '<td>' + (i + 1) + '</td>';
				        data += '<td>' + details[0] + '</td>';
				        data += '<td>[' + details[1] + ']</td>';
				        data += '<td colspan=2><button onclick="address.Edit(' + i + ')">Edit</button> |';
		        		data += '| <button onclick="address.Delete(' + i + ')">Delete</button></td>';
		        		data += '</tr>';
		      		}
		    	}
	    		this.Count(this.contacts.length);
	    		return this.contactList.innerHTML = data;
	  		};
	  
	  		this.Add = function () {
	  			var contactName = document.getElementById('addContactName').value;
	  			var contactNumber = document.getElementById('addContactNumber').value;

	  			if(contactName === " " || contactNumber === " "){
	  				alert("All Fields Are Required!");
	  				return false;
	  			}

		    	contactDetails = document.getElementById('addContactName').value + " __" + document.getElementById('addContactNumber').value;
		    	// Get the value
		    	var contact = contactDetails;
		    	if (contact) {
		      		// Add the new value
		      		this.contacts.push(contact.trim());
		      		// Reset input value
		      		//el = '';
		      		document.getElementById('addContactName').value = " ";
		      		document.getElementById('addContactNumber').value = " ";
		      		// Dislay the new list
		      		this.FetchAll();
		    	}
	  		};

	  		this.Edit = function (item) {
	    		var contactName = document.getElementById('editContactName');
	    		var contactNumber = document.getElementById('editContactNumber');
	    		// Display value in the field
	    		var con = this.contacts[item].split(" __");
	    		contactName.value = con[0];
	    		contactNumber.value = con[1];
	    		// Display fields
	    		document.getElementById('editForm').style.display = 'block';
	    		self = this;
	    		document.getElementById('saveEdit').onsubmit = function() {
	      		// Get value
	      			if(contactName.value === " " || contactNumber.value === " "){
		  				alert("All Fields Are Required!");
		  				return false;
		  			}
		      		var contact = contactName.value + " __" + contactNumber.value;
		      		if (contact) {
		        		// Edit value
		        		self.contacts.splice(item, 1, contact.trim());
		        		// Display the new list
		        		self.FetchAll();
		        		// Hide fields
		        		CloseInput();
		      		}
		    	}
	  		};

	  		this.Delete = function (item) {
		    	// Delete the current row
		    	this.contacts.splice(item, 1);
		    	// Display the new list
		    	this.FetchAll();
	  		};
		}

		address.FetchAll();

		function CloseInput() {
	  		document.getElementById('editForm').style.display = 'none';
		}
	</script>
</body>
</html>